import{u as F,j as e,J as A,q as P,c as S,b as k,f as x}from"./ConfirmationContext-BgD69WF4.js";import{r as a}from"./vendor-CfxRerCp.js";import{T,t as h}from"./index-Bgz36SJa.js";import{H as $}from"./Header-Bo__bH6N.js";import{S as E,Y as R}from"./YearFilterComponent-v280wgLX.js";import{A as B,R as I}from"./RssSubscribeLink-DEqEFmRz.js";import{R as _}from"./RecentActivityFeed-CLEedQS9.js";import{B as D}from"./BlogPost-JX0jJTsS.js";import{P as L}from"./PortfolioLink-CCngsXnA.js";import{N as z}from"./Navbar-3pRjB-Lg.js";import{a as v}from"./axiosInstance-XGWuhqFT.js";import"./Spinner4-BBfDOIyg.js";import"./index-DHe08Kkl.js";function H({slug:r}){const[c,m]=a.useState([]),{theme:n}=F();a.useEffect(()=>{fetch(`/posts/${r}/suggested`).then(s=>s.json()).then(s=>m(s)).catch(s=>console.error(s))},[r]);const i=s=>{s.currentTarget.onerror=null,s.currentTarget.src="/fallbackimage.jpg"};return c.length?e.jsxs("div",{className:"w-full flex flex-col items-center md:items-start !mt-6 md:!mt-8 !pt-4 md:!pt-6 border-t border-[#5800FF]/20 2xl:!ml-32 xl:w-4/5",children:[e.jsx("h3",{className:"{`font-semibold !text-lg lg:!text-2xl xl:!text-3xl ${theme === 'white' ? 'text-black' : 'text-white'}`} !mb-6 lg:!mb-14 sm:!pl-10",children:"Suggested posts for you:"}),e.jsx("ul",{className:"flex flex-col !gap-4 w-full",children:c.map(s=>e.jsx("li",{className:"flex items-center bg-[#5800FF]/10 rounded-lg shadow !p-3 !pl-10 hover:shadow-lg transition-shadow w-full",children:e.jsxs(A,{href:`/posts/${s.slug}`,className:"flex items-center w-full",children:[e.jsx("img",{src:s.image_path?`/storage/${s.image_path}`:"/fallbackimage.jpg",alt:s.title,onError:i,className:"!w-14 !h-14 md:!w-16 md:!h-16 object-cover rounded-full bg-white/20 !mr-4",loading:"lazy"}),e.jsx("span",{className:"{`${theme === 'white' ? 'text-black' : 'text-white'}`} font-medium hover:underline text-sm md:text-base line-clamp-2 !ml-6",children:s.title})]})},s.id))})]}):null}const oe=({post:r})=>{const{props:c}=P(),{theme:m}=F(),n=c.allPosts??{},{auth:i,topics:s,currentTopic:u,flash:l}=c,p=i==null?void 0:i.user,{confirm:J}=S(),f=p?!!p.is_admin:!1,[O,Y]=a.useState(""),[q,U]=a.useState(!1),[g,j]=a.useState([]),{showAlert:d}=k(),b=Array.isArray(n)?n:(n==null?void 0:n.data)||[];a.useEffect(()=>{async function t(){try{const C=(await v.get(`api/comments/${r.id}`)).data.map(N=>({...N,createdAt:new Date(N.createdAt).toISOString()}));j(C)}catch(o){console.error("Failed to fetch comments",o),h.error("Failed to load comments")}}t()},[r.id]),a.useEffect(()=>{l!=null&&l.success&&d(l.success,"success"),l!=null&&l.error&&d(l.error,"error"),l!=null&&l.info&&d(l.info,"info")},[l]);const w=t=>{const o=new URLSearchParams;t&&o.append("topic",t),x.get("/",Object.fromEntries(o))},y=async t=>{try{await v.delete(`/api/comments/${t}`),j(g.filter(o=>o._id!==t)),h.success("Comment deleted successfully!")}catch(o){console.error("Failed to delete comment",o),h.error("Failed to delete comment. Please try again.")}};return e.jsx("div",{className:`min-h-160 ${m}`,children:e.jsxs("div",{className:"min-h-160 bg-[var(--bg-primary)] text-[var(--text-primary)]",children:[e.jsx(z,{}),e.jsx($,{}),e.jsx("main",{className:"!p-4 md:!p-8 !gap-1",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 md:gap-6 custom-2xl-gap items-center lg:items-start",children:[e.jsx("aside",{className:"hidden lg:block w-full md:!w-2/3 xl:!w-2/3 xl:!ml-20 2xl:!ml-30 xl:max-w-120 xl:!mr-10 !mb-8 lg:!mb-0 mx-auto",children:e.jsxs("div",{className:"lg:top-24 !space-y-4 md:!space-y-6 flexcontainer w-full lg:!w-80 xl:!w-120",children:[e.jsxs("div",{className:"rounded-lg bg-[#5800FF]/10 !p-4 2xl:!pl-6",children:[e.jsx("h3",{className:"font-semibold !mb-2",children:"About This Post"}),e.jsxs("p",{className:"opacity-80",children:["This is a blog post about ",r.topic||"various topics","."]})]}),e.jsxs("div",{className:"rounded-lg bg-[#5800FF]/10 !p-4 2xl:!pl-6",children:[e.jsx("h3",{className:"font-semibold !mb-2",children:"Actions"}),e.jsxs("ul",{className:"!space-y-1",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>x.visit("/"),className:"w-full text-left !px-2 !py-1 rounded hover:bg-[#5800FF]/20",children:"Back to All Posts"})}),f&&e.jsx("li",{children:e.jsx("button",{onClick:()=>x.visit(`/post/${r.id}/edit`),className:"w-full text-left !px-2 !py-1 rounded hover:bg-[#5800FF]/20",children:"Edit Post"})})]})]}),e.jsxs("div",{className:"rounded-lg bg-[#5800FF]/10 !p-4 2xl:!pl-6",children:[s&&e.jsxs("div",{className:"!mb-4",children:[e.jsx("h3",{className:"font-semibold !mb-2",children:"Topics"}),e.jsxs("ul",{className:"!space-y-1",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>w(null),className:`w-full text-left !px-2 !py-1 rounded ${u===null?"bg-[#5800FF] text-white":"hover:bg-[#5800FF]/20"}`,children:"All Topics"})}),s.map(t=>e.jsx("li",{children:e.jsx("button",{onClick:()=>w(t),className:`w-full text-left !px-2 !py-1 rounded ${u===t?"bg-[#5800FF] text-white":"hover:bg-[#5800FF]/20"}`,children:t})},t))]})]}),e.jsx(E,{posts:b}),e.jsx(R,{posts:b}),e.jsx(B,{}),e.jsx(_,{},"recent-activity-feed"),e.jsx(I,{}),e.jsx(L,{})]})]})}),e.jsx("div",{className:"flex flex-col items-center lg:-translate-x-14",children:e.jsxs("div",{className:"!space-y-6 md:!space-y-8",children:[e.jsx(D,{post:r,comments:g,isAdmin:f,onReply:t=>{},onEdit:(t,o)=>{},onDelete:y,isPostPage:!0,showComments:!0}),r.slug?e.jsx(H,{slug:r.slug}):e.jsx("div",{children:"Check out my other posts!"})]})})]})}),e.jsx(T,{})]})})};export{oe as default};
