import{q as k,u as E,j as e,f as d}from"./axiosInstance-B60J37ny.js";import{T as _}from"./index-BgMHZnzL.js";import{B as $}from"./BlogPost-BOJTk0jN.js";import{H as S}from"./Header-DLvWApgL.js";import{S as A,Y as M}from"./YearFilterComponent-CahbW65Z.js";import{T as U}from"./Tags-Dncaw-CO.js";import{N as L}from"./app-BZ86fJkl.js";import{r as m}from"./vendor-CfxRerCp.js";import"./Spinner4-BhOwiG6x.js";import"./index-BwfBZVYM.js";function z(){var b;const{props:f}=k(),{theme:x}=E(),[j,v]=m.useState([]),{posts:p,allPosts:g,topics:F,currentTopic:o,currentPage:a,hasMore:N,total:n,archiveYear:l,auth:c}=f;(b=c==null?void 0:c.user)==null||b.is_admin;const[h,w]=m.useState(a+1);m.useEffect(()=>{(async()=>{const i=await(await fetch("/api/tags")).json();v(i)})()},[]);const r=t=>{const s=new URLSearchParams;o&&s.append("topic",o),s.append("page",(t+1).toString()),d.get(`/archives/${l}`,Object.fromEntries(s))},u=t=>{const s=new URLSearchParams;t&&s.append("topic",t),d.get(`/archives/${l}`,Object.fromEntries(s))},y=()=>{r(0)},C=()=>{r(Math.ceil(n/6)-1)},T=t=>{if(t.key==="Enter"){const s=h;s>=1&&s<=Math.ceil(n/6)&&r(s-1)}};return e.jsx("div",{className:`min-h-160 ${x}`,children:e.jsxs("div",{className:"min-h-160 bg-[var(--bg-primary)] text-[var(--text-primary)]",children:[e.jsx(L,{}),e.jsx(S,{}),e.jsx("main",{className:"!p-4 md:!p-8 !gap-1",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 md:gap-6 xl:gap-10 custom-2xl-gap",children:[e.jsx("aside",{className:"hidden lg:block w-full md:!w-2/3 xl:!w-2/3 xl:!ml-20 2xl:!ml-30 xl:max-w-120 xl:!mr-10 !mb-8 lg:!mb-0 mx-auto",children:e.jsxs("div",{className:"lg:top-24 !space-y-4 md:!space-y-6 w-full lg:!w-80 xl:!w-120",children:[e.jsxs("div",{className:"rounded-lg bg-[#5800FF]/10 !p-4 2xl:!pl-6",children:[e.jsx("h3",{className:"font-semibold !mb-2",children:"About"}),e.jsxs("p",{className:"opacity-80",children:["Viewing posts from ",e.jsx("strong",{children:l}),". Browse other years or topics to explore more."]})]}),e.jsxs("div",{className:"rounded-lg bg-[#5800FF]/10 !p-4 2xl:!pl-6 ",children:[e.jsx("h3",{className:"font-semibold !mb-2",children:"Topics"}),e.jsx("div",{className:"!mb-2",children:e.jsx("button",{onClick:()=>u(null),className:`w-full text-left !px-2 !mb-1 !py-1 rounded ${o===null?"bg-[#5800FF] text-white":"hover:bg-[#5800FF]/20"}`,children:"All Topics"})}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:F.slice().sort((t,s)=>t.localeCompare(s)).map(t=>e.jsx("button",{onClick:()=>u(t),className:`text-center !px-2 !py-1 rounded border text-sm border-[#5800FF]/30 ${o===t?"bg-[#5800FF] text-white":"hover:bg-[#5800FF]/20"}`,children:t},t))})]}),e.jsxs("div",{className:"rounded-lg bg-[#5800FF]/10 !p-4 2xl:!pl-6",children:[e.jsx(A,{posts:g}),e.jsx(M,{posts:g}),e.jsx(U,{tags:j,onTagClick:t=>d.visit(`/posts/tag/${t}`)})]})]})}),e.jsx("div",{className:"flex flex-col items-center w-full lg:-translate-x-14",children:e.jsxs("div",{className:"!space-y-8",children:[e.jsxs("h2",{className:"text-2xl font-bold w-full !mb-10 lg:!ml-20 xl:!ml-14 text-center lg:text-left !mt-4 xl:!mt-6",children:["Archive â€” Posts from ",l,":"]}),p.data.length===0?e.jsxs("div",{className:"text-center opacity-70 !mt-30",children:["No blog posts found for ",l,"."]}):e.jsxs(e.Fragment,{children:[p.data.map(t=>{const s=t.image_url||void 0,i=t.slug&&t.slug!=="slug"?t.slug:void 0,P=t.author&&t.author!=="author"?t.author:"Unknown";return e.jsx("div",{className:"relative",children:e.jsx($,{post:{title:t.title,content:t.content,topic:t.topic,id:t.id,_id:t.id.toString(),image_url:s,slug:i,author:P,created_at:t.created_at,updated_at:t.updated_at||t.created_at,postUrl:i?`/post/${i}`:`/post/${t.id}`}})},t.id)}),e.jsxs("div",{className:"flex justify-center items-center lg:!ml-10 !gap-2 md:!gap-4 !mt-8 md:!mt-18 md:!mb-10 customdiv",children:[e.jsx("button",{onClick:y,disabled:a===0,className:"paginationbutton !px-3 !py-1 md:!px-4 md:!py-2 bg-[#5800FF] text-white rounded hover:bg-[#E900FF] disabled:opacity-50 transition-colors text-sm md:text-base",children:e.jsx("img",{src:"/first.svg",alt:"First"})}),e.jsx("button",{onClick:()=>r(a-1),disabled:a===0,className:"paginationbutton !px-3 !py-1 md:!px-4 md:!py-2 bg-[#5800FF] text-white rounded hover:bg-[#E900FF] disabled:opacity-50 transition-colors text-sm md:text-base",children:"Previous"}),e.jsxs("span",{className:"text-sm md:text-base",children:["Page ",a+1," of ",Math.ceil(n/6)]}),e.jsx("input",{type:"number",value:h,onChange:t=>w(parseInt(t.target.value)),onKeyDown:T,className:`w-10 md:w-12 !h-8 text-sm !pr-1 md:text-base text-center ${x==="dark"?"bg-primary":"bg-white"} border border-gray-300 rounded`}),e.jsx("button",{onClick:()=>r(a+1),disabled:!N,className:"paginationbutton !px-3 !py-1 md:!px-4 md:!py-2 bg-[#5800FF] text-white rounded hover:bg-[#E900FF] disabled:opacity-50 transition-colors text-sm md:text-base",children:"Next"}),e.jsx("button",{onClick:C,disabled:a===Math.ceil(n/6)-1,className:"paginationbutton !px-3 !py-1 md:!px-4 md:!py-2 bg-[#5800FF] text-white rounded hover:bg-[#E900FF] disabled:opacity-50 transition-colors text-sm md:text-base",children:e.jsx("img",{src:"/last.svg",alt:"Last"})})]})]})]})})]})}),e.jsx(_,{})]})})}export{z as default};
